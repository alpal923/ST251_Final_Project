---
title: "Stat 251 Final Project: Disney vs. Lucasfilm"
author: "Aaron Brown, Aly Milne, Andrew Bergeron"
date: "11/15/2023"
output: pdf_document
---

```{r setup, include=FALSE}
library(tinytex)
library(tidyverse)
library(vroom)
library(invgamma)
library(readxl)
```

```{r answer1b}
# Read in data
star_wars_raw <- read.csv("cleaned_SW_ratings.csv")
# view(star_wars_main)

star_wars_clean <- star_wars_raw[!is.na(star_wars_raw$AverageRating), ]
# rownames(star_wars_clean) <- NULL
# view(star_wars_clean)

# Mean avg rating
mean(star_wars_clean$AverageRating)
```

```{r answer1a}
# PRIOR PARAMETERS: We'll use the same prior for both populations
# How would I change the code to allow for different priors for the two populations?
# Prior parameters for mu: 
lambda <- 8 # Bestsellers will have higher reviews
tau2 <- 20 # leave room for uncertainty
# Prior parameters for sigma2: 
# possible range for reviews is ~1-10, 
# then an approximate standard deviation would be 9/12
# so an approximate variance would be 0.4444
gamma <- 2.01
phi <- 0.666666
#prior expected value of variance: 
phi/(gamma-1)
```

```{r answer1c}
# Plot the prior distributions to make sure they seem reasonable
par(mfrow=c(1,2))
curve(dnorm(x, lambda, sqrt(tau2)), xlim=c(-5, 25), ylab="prior density", main=expression(pi(mu)), xlab=expression(mu))
curve(dinvgamma(x, gamma, phi), xlim=c(0, 3), ylab="prior density", main=expression(pi(sigma^2)), xlab=expression(sigma^2))
```

Disney acquisition was end of 2012, so everything prior to and in the year of 2012 will be LucasFilm and 2013 and after will be Disney.
```{r}
data_before_2013 <- filter(star_wars_clean, startYear < 2013)
data_2013_and_after <- filter(star_wars_clean, startYear >= 2013)
```


